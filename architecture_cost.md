#服务器费用计算

> 以下使用青云服务器价格计算 https://www.qingcloud.com/pricing/plan

## 假设
1. 第1月达到 `1w dau`，总用户数 `50w`（待调整）
2. 第12月达到 `10w dau`，总用户数 `100w`（待调整）
3. 视频长度均值为 `20m`（可能偏长）
4. 视频大小约为 `25MB`
5. 假设上传视频的用户占总用户数的 `20%`，并且人均上传的视频第1月为 `3个`，第12月为 `8个`（带调整）

## 费用估算
### 估算模型
使用等比数列，首先分别计算出1月和12月的费用，在求等比数列总和。

### 1月费用（3500.00元）
#####1. 同时在线人数最大值估算
假设1w用户集中在一天的15小时内，那么每小时用户数为：`667/h`
同一时刻在线人数约为：`100人`（除以6，待调整）

#####2.带宽估算
一个20分钟视频大小为25MB的视频码流为:
`25MB * 1024KB * 1024B * 8b / (20m * 60s) ~= 174763(b/s)`

10M独享带宽能支撑的同时在线人数：
`10Mbps * 1024 * 1024 / 174763 ~= 60人`

所以，支撑100人同时在线至少需要带宽为：
`174763 * 100 / (1024 * 1024) ~= 17(Mbps)

#####3. 存储估算
总视频大小为：
`50w * 0.2 * 20MB * 3 / 1024MB ~= 5859(GB) ~= 5TB`

####4. 设备选择
主机：LInux 4 核 8G 内存 * 1 = 489.6元

公网IP EIP：17Mbps = 1193.40元

小型路由器：36元

负载均衡器：5000并发（最小的）= 36元

硬盘：容量性5TB *1 = 1620元

总和：3375.00元

其他未选择：比如缓存、Snapshot、RDB、映像等服务，所以总和调整为`3500.00元`。

### 12月费用（25000.00元）

#####1. 同时在线人数最大值估算
假设10w用户集中在一天的15小时内，那么每小时用户数为：`6670/h`
同一时刻在线人数约为：`1000人`（除以6，待调整）

#####2.带宽估算
视频码流（同上）约为:`174763(b/s)`
所以，支撑1000人同时在线至少需要带宽为：
`174763 * 1000 / (1024 * 1024) ~= 170(Mbps)`

#####3. 存储估算
总视频大小为：
`100w * 0.2 * 20MB * 8 / 1024MB ~= 31250(GB) ~= 30(TB)`

####4. 设备选择
主机：LInux 4 核 8G 内存 * 1 = 489.6元

公网IP EIP：170Mbps = 11934元

中型路由器：136.8元

负载均衡器：5000并发（最小的）= 36元

硬盘：容量性5TB * 6 = 9720元

总和：22316.40元

其他未选择：比如缓存、Snapshot、RDB、映像等服务，所以总和调整为`25000.00元`。

### 结论
1月：`3500`

12月：`25000`

等比数列比例约为：`1.2`

一年总费用约为：`138532.00元`

### 其他未计算
1. CDN 服务可能需要单独收费